{"ast":null,"code":"var _jsxFileName = \"/Users/acaciano/Projects/2a/55PBXTest/front-end/src/pages/Profile/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useRef, useState } from 'react';\nimport { FiUser, FiMail, FiPhone, FiCamera, FiArrowLeft } from 'react-icons/fi';\nimport { Form } from '@unform/web';\nimport * as Yup from 'yup';\nimport api from '../../services/api';\nimport getValidationErrors from '../../utils/getValidationErrors';\nimport { Container, Content, AvatarInput } from './styles';\nimport Input from '../../components/Input';\nimport Button from '../../components/Button';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useToast } from '../../hooks/toast';\nimport { useAuth } from '../../hooks/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Profile = () => {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const formRef = useRef(null);\n  const {\n    addToast\n  } = useToast();\n  const history = useHistory();\n  const {\n    user,\n    updateUser\n  } = useAuth();\n  const handleSubmit = useCallback(async data => {\n    try {\n      var _formRef$current;\n\n      setLoading(true);\n      (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setErrors({});\n      const schema = Yup.object().shape({\n        name: Yup.string().required('Nome é obrigatório'),\n        email: Yup.string().required('E-mail é obrigatório').email('Digite um e-mail vãlido!'),\n        cellPhone: Yup.string().required('Celular é obrigatório')\n      });\n      await schema.validate(data, {\n        abortEarly: false\n      });\n      await api.put(`/v1/person/${user.id}`, data).then(response => {\n        updateUser(response.data.data);\n      });\n      history.push('/');\n      addToast({\n        type: 'success',\n        title: 'Perfil  atualizado!',\n        description: 'Suas inforamções do perfil foram atualizadas com sucesso!.'\n      });\n    } catch (err) {\n      if (err instanceof Yup.ValidationError) {\n        var _formRef$current2;\n\n        const errors = getValidationErrors(err);\n        if (errors) (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.setErrors(errors);\n        return;\n      } else {\n        addToast({\n          type: 'error',\n          title: 'Erro na atualização',\n          description: 'Ocorreu um erro ao atualizar o perfil, tente novamente!'\n        });\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [addToast, history]);\n  const handleAvatarChange = useCallback(e => {\n    if (e.target.files) {\n      const data = new FormData();\n      data.append('avatar', e.target.files[0]);\n      api.post('v1/person/avatar', data).then(response => {\n        updateUser(response.data.data);\n        addToast({\n          type: 'success',\n          title: 'Avatar atualizado!'\n        });\n      });\n    }\n  }, [addToast]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/dashboard\",\n          children: /*#__PURE__*/_jsxDEV(FiArrowLeft, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Content, {\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        ref: formRef,\n        initialData: {\n          name: user.name,\n          email: user.email,\n          cellPhone: user.cellPhone\n        },\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(AvatarInput, {\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: 'data:image/png;base64,' + user.avatar,\n            alt: user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"avatar\",\n            children: [/*#__PURE__*/_jsxDEV(FiCamera, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              id: \"avatar\",\n              onChange: handleAvatarChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Meu perfil\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          name: \"name\",\n          icon: FiUser,\n          type: \"text\",\n          placeholder: \"Nome\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          name: \"email\",\n          icon: FiMail,\n          type: \"text\",\n          placeholder: \"E-mail\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          name: \"cellPhone\",\n          icon: FiPhone,\n          type: \"text\",\n          mask: \"cellPhone\",\n          placeholder: \"Celular\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          loading: loading,\n          type: \"submit\",\n          children: \"Confirmar mudan\\xE7as\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Profile, \"PfIFB3gQm4QZgxLTzqCUdGRSyu0=\", false, function () {\n  return [useToast, useHistory, useAuth];\n});\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["/Users/acaciano/Projects/2a/55PBXTest/front-end/src/pages/Profile/index.tsx"],"names":["React","useCallback","useRef","useState","FiUser","FiMail","FiPhone","FiCamera","FiArrowLeft","Form","Yup","api","getValidationErrors","Container","Content","AvatarInput","Input","Button","Link","useHistory","useToast","useAuth","Profile","loading","setLoading","formRef","addToast","history","user","updateUser","handleSubmit","data","current","setErrors","schema","object","shape","name","string","required","email","cellPhone","validate","abortEarly","put","id","then","response","push","type","title","description","err","ValidationError","errors","handleAvatarChange","e","target","files","FormData","append","post","avatar"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, useCallback, useRef, useState } from 'react';\nimport { FiUser, FiMail, FiPhone, FiCamera, FiArrowLeft } from 'react-icons/fi'\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\n\nimport * as Yup from 'yup';\n\nimport api from '../../services/api';\n\nimport getValidationErrors from '../../utils/getValidationErrors';\n\nimport { Container, Content, AvatarInput } from './styles'\n\nimport Input from '../../components/Input';\nimport Button from '../../components/Button';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useToast } from '../../hooks/toast';\nimport { useAuth } from '../../hooks/auth';\nimport ResponseBase from '../../models/ResponseBase';\nimport UserData from '../../models/UserData';\n\ninterface ProfileFormData {\n    name: string,\n    email: string,\n    cellPhone: string,\n}\n\nconst Profile: React.FC = () => {\n\n    const [loading, setLoading] = useState(false);\n    const formRef = useRef<FormHandles>(null);\n    const { addToast } = useToast();\n    const history = useHistory();\n\n    const { user, updateUser } = useAuth();\n\n    const handleSubmit = useCallback(async (data: ProfileFormData) => {\n        try {\n            setLoading(true);\n            formRef.current?.setErrors({});\n\n            const schema = Yup.object().shape({\n                name: Yup.string().required('Nome é obrigatório'),\n                email: Yup.string().required('E-mail é obrigatório').email('Digite um e-mail vãlido!'),\n                cellPhone: Yup.string().required('Celular é obrigatório'),\n            });\n\n            await schema.validate(data, {\n                abortEarly: false\n            });\n\n            await api.put(`/v1/person/${user.id}`, data).then((response) => {\n                updateUser(response.data.data);\n            });\n\n            history.push('/');\n\n            addToast({\n                type: 'success',\n                title: 'Perfil  atualizado!',\n                description: 'Suas inforamções do perfil foram atualizadas com sucesso!.'\n            });\n        } catch (err) {\n\n            if (err instanceof Yup.ValidationError) {\n                const errors = getValidationErrors(err);\n\n                if (errors) formRef.current?.setErrors(errors);\n\n                return;\n            } else {\n                addToast({\n                    type: 'error',\n                    title: 'Erro na atualização',\n                    description: 'Ocorreu um erro ao atualizar o perfil, tente novamente!'\n                });\n            }\n        } finally {\n            setLoading(false);\n        }\n    }, [addToast, history]);\n\n    const handleAvatarChange = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n        if (e.target.files) {\n            const data = new FormData();\n            data.append('avatar', e.target.files[0]);\n\n            api.post<ResponseBase<UserData>>('v1/person/avatar', data).then((response) => {\n                updateUser(response.data.data);\n                addToast({\n                    type: 'success',\n                    title: 'Avatar atualizado!'\n                });\n            });\n        }\n    }, [addToast])\n\n    return (\n        <Container>\n\n            <header>\n                <div>\n                    <Link to=\"/dashboard\">\n                        <FiArrowLeft />\n                    </Link>\n                </div>\n            </header>\n\n            <Content>\n                <Form ref={formRef} initialData={{\n                    name: user.name,\n                    email: user.email,\n                    cellPhone: user.cellPhone\n                }} onSubmit={handleSubmit}>\n\n                    <AvatarInput>\n                        <img src={'data:image/png;base64,' + user.avatar} alt={user.name} />\n                        <label htmlFor=\"avatar\">\n                            <FiCamera />\n                            <input type=\"file\" id=\"avatar\" onChange={handleAvatarChange} />\n                        </label>\n                    </AvatarInput>\n\n                    <h1>Meu perfil</h1>\n                    <Input name=\"name\" icon={FiUser} type=\"text\" placeholder=\"Nome\" />\n                    <Input name=\"email\" icon={FiMail} type=\"text\" placeholder=\"E-mail\" />\n                    <Input name=\"cellPhone\" icon={FiPhone} type=\"text\" mask=\"cellPhone\" placeholder=\"Celular\" />\n\n                    <Button loading={loading} type=\"submit\">Confirmar mudanças</Button>\n                </Form>\n            </Content>\n        </Container>\n    )\n\n};\n\nexport default Profile;"]},"metadata":{},"sourceType":"module"}